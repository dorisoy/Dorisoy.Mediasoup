<ui:FluentWindow x:Class="Dorisoy.Meeting.Client.Views.ScreenCaptureOverlay"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
                 Title="屏幕截取"
                 WindowStyle="None"
                 AllowsTransparency="True"
                 Background="Transparent"
                 Topmost="True"
                 ShowInTaskbar="False"
                 ResizeMode="NoResize"
                 WindowState="Maximized"
                 Cursor="Cross">
    <Grid x:Name="RootGrid">
        <!-- 半透明遮罩层 -->
        <Canvas x:Name="OverlayCanvas" 
                Background="#50000000"
                MouseLeftButtonDown="Canvas_MouseLeftButtonDown"
                MouseMove="Canvas_MouseMove"
                MouseLeftButtonUp="Canvas_MouseLeftButtonUp">
            
            <!-- 选择区域（通过剪切实现透明） -->
            <Canvas.Clip>
                <CombinedGeometry GeometryCombineMode="Exclude">
                    <CombinedGeometry.Geometry1>
                        <RectangleGeometry x:Name="FullScreenGeometry"/>
                    </CombinedGeometry.Geometry1>
                    <CombinedGeometry.Geometry2>
                        <RectangleGeometry x:Name="SelectionGeometry" Rect="0,0,0,0"/>
                    </CombinedGeometry.Geometry2>
                </CombinedGeometry>
            </Canvas.Clip>
        </Canvas>
        
        <!-- 选择区域边框 -->
        <Border x:Name="SelectionBorder"
                BorderBrush="#00AAFF"
                BorderThickness="2"
                Background="Transparent"
                Visibility="Collapsed"
                IsHitTestVisible="False">
            <Border.Effect>
                <DropShadowEffect Color="#00AAFF" BlurRadius="10" ShadowDepth="0" Opacity="0.5"/>
            </Border.Effect>
        </Border>
        
        <!-- 选区尺寸提示 -->
        <Border x:Name="SizeHint"
                Background="#E0333333"
                CornerRadius="4"
                Padding="8,4"
                HorizontalAlignment="Left"
                VerticalAlignment="Top"
                Visibility="Collapsed"
                IsHitTestVisible="False">
            <TextBlock x:Name="SizeText"
                       Foreground="White"
                       FontSize="12"
                       FontFamily="Consolas"/>
        </Border>
        
        <!-- 工具栏（选择完成后显示） -->
        <Border x:Name="Toolbar"
                Background="#E0333333"
                CornerRadius="8"
                Padding="8,6"
                HorizontalAlignment="Left"
                VerticalAlignment="Top"
                Visibility="Collapsed">
            <StackPanel Orientation="Horizontal">
                <ui:Button x:Name="BtnConfirm"
                           Width="32" Height="32"
                           CornerRadius="4"
                           Margin="2,0"
                           ToolTip="确定 (Enter)"
                           Appearance="Primary"
                           Click="BtnConfirm_Click">
                    <ui:SymbolIcon Symbol="Checkmark20" FontSize="16"/>
                </ui:Button>
                <ui:Button x:Name="BtnCancel"
                           Width="32" Height="32"
                           CornerRadius="4"
                           Margin="2,0"
                           ToolTip="取消 (Esc)"
                           Appearance="Secondary"
                           Click="BtnCancel_Click">
                    <ui:SymbolIcon Symbol="Dismiss20" FontSize="16"/>
                </ui:Button>
            </StackPanel>
        </Border>
        
        <!-- 提示文字 -->
        <TextBlock x:Name="HintText"
                   Text="按住鼠标左键拖动选择截图区域，按 Esc 取消"
                   Foreground="White"
                   FontSize="14"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"
                   IsHitTestVisible="False">
            <TextBlock.Effect>
                <DropShadowEffect Color="Black" BlurRadius="5" ShadowDepth="1"/>
            </TextBlock.Effect>
        </TextBlock>
    </Grid>
</ui:FluentWindow>
