<ui:FluentWindow x:Class="Dorisoy.Meeting.Client.Views.CollaborativeEditorWindow"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
                 Title="协同编辑器"
                 Width="900"
                 Height="600"
                 MinWidth="600"
                 MinHeight="400"
                 d:DesignHeight="600"
                 d:DesignWidth="900"
                 ui:Design.Background="{DynamicResource ApplicationBackgroundBrush}"
                 ui:Design.Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                 ExtendsContentIntoTitleBar="True"
                 WindowBackdropType="Mica"
                 WindowCornerPreference="Default"
                 WindowStartupLocation="CenterOwner"
                 mc:Ignorable="d">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 标题栏 -->
        <ui:TitleBar x:Name="TitleBar"
                     Title="协同编辑器"
                     Grid.Row="0"/>

        <!-- 工具栏 -->
        <Menu Grid.Row="1"
              Background="Transparent"
              FontSize="14">
            <ui:MenuItem Header="文件" Icon="{ui:SymbolIcon DocumentSplitHint20}">
                <MenuItem x:Name="MenuSave"
                          Header="保存"
                          Click="MenuSave_Click"/>
                <MenuItem x:Name="MenuSaveAs"
                          Header="另存为..."
                          Click="MenuSaveAs_Click"/>
                <Separator/>
                <MenuItem x:Name="MenuClose"
                          Header="关闭"
                          Click="MenuClose_Click"/>
            </ui:MenuItem>
            <ui:MenuItem Header="编辑" Icon="{ui:SymbolIcon DocumentEdit20}">
                <MenuItem x:Name="MenuUndo"
                          Header="撤销"
                          Click="MenuUndo_Click"/>
                <MenuItem x:Name="MenuRedo"
                          Header="重做"
                          Click="MenuRedo_Click"/>
                <Separator/>
                <MenuItem x:Name="MenuCut"
                          Header="剪切"
                          Click="MenuCut_Click"/>
                <MenuItem x:Name="MenuCopy"
                          Header="复制"
                          Click="MenuCopy_Click"/>
                <MenuItem x:Name="MenuPaste"
                          Header="粘贴"
                          Click="MenuPaste_Click"/>
                <Separator/>
                <MenuItem x:Name="MenuSelectAll"
                          Header="全选"
                          Click="MenuSelectAll_Click"/>
            </ui:MenuItem>
            <Separator/>
            <!-- 格式化按钮 -->
            <ui:MenuItem x:Name="BtnBold"
                         Icon="{ui:SymbolIcon TextBold20}"
                         ToolTip="粗体"
                         Click="BtnBold_Click"/>
            <ui:MenuItem x:Name="BtnItalic"
                         Icon="{ui:SymbolIcon TextItalic20}"
                         ToolTip="斜体"
                         Click="BtnItalic_Click"/>
            <ui:MenuItem x:Name="BtnUnderline"
                         Icon="{ui:SymbolIcon TextUnderline20}"
                         ToolTip="下划线"
                         Click="BtnUnderline_Click"/>
            <Separator/>
            <ui:MenuItem x:Name="BtnFont"
                         Icon="{ui:SymbolIcon TextFont20}"
                         ToolTip="字体"
                         Click="BtnFont_Click"/>
            <ui:MenuItem x:Name="BtnFontSize"
                         Icon="{ui:SymbolIcon TextFontSize20}"
                         ToolTip="字号">
                <MenuItem Header="小 (10)" Tag="10" Click="FontSize_Click"/>
                <MenuItem Header="正常 (12)" Tag="12" Click="FontSize_Click"/>
                <MenuItem Header="中 (14)" Tag="14" Click="FontSize_Click"/>
                <MenuItem Header="大 (18)" Tag="18" Click="FontSize_Click"/>
                <MenuItem Header="超大 (24)" Tag="24" Click="FontSize_Click"/>
            </ui:MenuItem>
            <Separator/>
            <ui:MenuItem x:Name="BtnAlignLeft"
                         Icon="{ui:SymbolIcon TextAlignLeft20}"
                         ToolTip="左对齐"
                         Click="BtnAlignLeft_Click"/>
            <ui:MenuItem x:Name="BtnAlignCenter"
                         Icon="{ui:SymbolIcon TextAlignCenter20}"
                         ToolTip="居中"
                         Click="BtnAlignCenter_Click"/>
            <ui:MenuItem x:Name="BtnAlignRight"
                         Icon="{ui:SymbolIcon TextAlignRight20}"
                         ToolTip="右对齐"
                         Click="BtnAlignRight_Click"/>
            <Separator/>
            <ui:MenuItem Header="视图" Icon="{ui:SymbolIcon Eye20}">
                <MenuItem x:Name="MenuWordWrap"
                          Header="自动换行"
                          IsCheckable="True"
                          IsChecked="True"
                          Click="MenuWordWrap_Click"/>
            </ui:MenuItem>
        </Menu>

        <!-- 富文本编辑器 -->
        <RichTextBox x:Name="RootTextBox"
                     Grid.Row="2"
                     Padding="12"
                     Background="Transparent"
                     BorderThickness="0"
                     AcceptsTab="True"
                     VerticalScrollBarVisibility="Auto"
                     HorizontalScrollBarVisibility="Disabled"
                     TextChanged="RootTextBox_TextChanged"
                     SelectionChanged="RootTextBox_SelectionChanged">
            <RichTextBox.Document>
                <FlowDocument FontFamily="Microsoft YaHei" FontSize="14">
                    <Paragraph>
                        <Run Text="协同编辑已开启，所有参会者可以同时编辑此文档。"/>
                    </Paragraph>
                </FlowDocument>
            </RichTextBox.Document>
        </RichTextBox>

        <!-- 状态栏 -->
        <StatusBar x:Name="RootStatusBar" Grid.Row="3" Background="Transparent">
            <StatusBar.ItemsPanel>
                <ItemsPanelTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                    </Grid>
                </ItemsPanelTemplate>
            </StatusBar.ItemsPanel>
            <StatusBarItem Grid.Column="0">
                <StackPanel Orientation="Horizontal">
                    <ui:SymbolIcon Symbol="Person20" Margin="0,0,4,0"/>
                    <TextBlock x:Name="TxtLastEditor" Text="等待编辑..." Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                </StackPanel>
            </StatusBarItem>
            <Separator Grid.Column="1"/>
            <StatusBarItem Grid.Column="2">
                <TextBlock x:Name="TxtSessionId" Text="" Foreground="{DynamicResource TextFillColorTertiaryBrush}"/>
            </StatusBarItem>
            <Separator Grid.Column="3"/>
            <StatusBarItem Grid.Column="4">
                <StackPanel Orientation="Horizontal">
                    <ui:SymbolIcon Symbol="Clock20" Margin="0,0,4,0"/>
                    <TextBlock x:Name="TxtUpdateTime" Text="--:--:--" Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                </StackPanel>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</ui:FluentWindow>
